local DlgTemplate = DlgTemplate
local DlgApi  = DlgApi
local GameApi = GameApi

---------------------------------------战魂技能数据库---------------------------------------
--某id的战魂技能对应的获得条件
--1. 列出该战魂技能每一等级需要的战魂四项属性的最小值。
--2. 所有在soul_id_skill中列出的战魂技能id都需要建一个对应的技能获得条件table。
--3. soul_skill_data[0]为空技能的获得条件，不可修改！
--4. 目前战魂技能最高为11级。
local soul_skill_data = {}
soul_skill_data[0] = {{999,999,999,999}}
----普通战魂技能----
--枪兵 啸风
soul_skill_data[2394] = {{86,97,93,82},{115,135,128,108},{143,173,163,134},{172,212,198,160},{201,250,233,186},{230,288,268,212},{259,326,303,238},{288,364,338,264},{317,403,373,290},{346,441,408,316},{375,479,443,342}}
soul_skill_data[2395] = {{1,1,1,1},{83,75,73,81},{117,100,95,111},{150,126,118,142},{183,151,141,172},{216,176,163,203},{250,201,186,233},{283,227,209,264},{316,252,232,294},{350,277,254,325},{383,302,277,355}}
--扇兵 鬼谋
soul_skill_data[2396] = {{86,82,93,97},{115,108,128,135},{143,134,163,173},{172,160,198,212},{201,186,233,250},{230,212,268,288},{259,238,303,326},{288,264,338,364},{317,290,373,403},{346,316,408,441},{375,342,443,479}}
soul_skill_data[2397] = {{1,1,1,1},{73,75,83,81},{95,100,117,111},{118,126,150,142},{141,151,183,172},{163,176,216,203},{186,201,250,233},{209,227,283,264},{232,252,316,294},{254,277,350,325},{277,302,383,355}}
----名将战魂技能----
--夏侯惇 狼目
soul_skill_data[2398] = {{135,115,128,109},{179,148,168,139},{222,182,208,169},{265,215,248,199},{309,248,288,229},{352,281,328,259},{395,314,367,289},{439,348,407,319},{482,381,447,349},{525,414,487,379},{569,447,527,409}}
soul_skill_data[2399] = {{94,77,72,88},{137,102,92,125},{180,127,112,162},{223,153,132,198},{266,178,152,235},{309,203,173,272},{352,228,193,308},{395,254,213,345},{438,279,233,382},{481,304,253,418},{524,329,273,455}}
soul_skill_data[2400] = {{1,1,1,1},{86,78,84,76},{120,103,114,98},{153,129,145,121},{186,154,175,144},{219,179,206,166},{253,204,236,189},{286,230,267,212},{319,255,297,235},{353,280,328,257},{386,305,358,280}}
--甄妃 洛神
soul_skill_data[2401] = {{115,150,128,97},{148,200,168,121},{182,251,208,146},{215,302,248,170},{248,353,288,194},{281,403,328,218},{314,454,367,242},{348,505,407,266},{381,556,447,290},{414,606,487,315},{447,657,527,339}}
soul_skill_data[2402] = {{85,108,100,78},{108,148,134,97},{132,188,168,116},{155,228,202,134},{179,268,236,153},{202,308,270,172},{226,348,304,190},{249,388,338,209},{272,428,372,228},{296,468,407,246},{319,508,441,265}}
soul_skill_data[2403] = {{1,1,1,1},{81,92,76,76},{109,131,98,98},{136,170,121,121},{164,209,144,144},{192,249,166,166},{220,288,189,189},{248,327,212,212},{276,366,235,235},{303,405,257,257},{331,444,280,280}}
--张辽 召虎
soul_skill_data[2404] = {{135,135,109,109},{179,179,139,139},{222,222,169,169},{265,265,199,199},{309,309,229,229},{352,352,259,259},{395,395,289,289},{439,439,319,319},{482,482,349,349},{525,525,379,379},{569,569,409,409}}
soul_skill_data[2405] = {{108,85,78,100},{148,108,97,134},{188,132,116,168},{228,155,134,202},{268,179,153,236},{308,202,172,270},{348,226,190,304},{388,249,209,338},{428,272,228,372},{468,296,246,407},{508,319,265,441}}
soul_skill_data[2406] = {{1,1,1,1},{78,86,84,76},{103,120,114,98},{129,153,145,121},{154,186,175,144},{179,219,206,166},{204,253,236,189},{230,286,267,212},{255,319,297,235},{280,353,328,257},{305,386,358,280}}
--关羽 武圣
soul_skill_data[2407] = {{135,115,109,128},{179,148,139,168},{222,182,169,208},{265,215,199,248},{309,248,229,288},{352,281,259,328},{395,314,289,367},{439,348,319,407},{482,381,349,447},{525,414,379,487},{569,447,409,527}}
soul_skill_data[2408] = {{108,78,100,85},{148,97,134,108},{188,116,168,132},{228,134,202,155},{268,153,236,179},{308,172,270,202},{348,190,304,226},{388,209,338,249},{428,228,372,272},{468,246,407,296},{508,265,441,319}}
soul_skill_data[2409] = {{1,1,1,1},{86,86,81,71},{120,120,109,89},{153,153,136,107},{186,186,164,125},{219,219,192,143},{253,253,220,160},{286,286,248,178},{319,319,276,196},{353,353,303,214},{386,386,331,232}}
--诸葛亮 伏龙
soul_skill_data[2411] = {{109,109,122,150},{139,139,158,200},{169,169,195,251},{199,199,231,302},{229,229,268,353},{259,259,304,403},{289,289,340,454},{319,319,377,505},{349,349,413,556},{379,379,450,606},{409,409,486,657}}
soul_skill_data[2410] = {{85,78,100,108},{108,97,134,148},{132,116,168,188},{155,134,202,228},{179,153,236,268},{202,172,270,308},{226,190,304,348},{249,209,338,388},{272,228,372,428},{296,246,407,468},{319,265,441,508}}
soul_skill_data[2412] = {{1,1,1,1},{76,76,92,81},{98,98,131,109},{121,121,170,136},{144,144,209,164},{166,166,249,192},{189,189,288,220},{212,212,327,248},{235,235,366,276},{257,257,405,303},{280,280,444,331}}
--黄忠 神射
soul_skill_data[2413] = {{115,135,128,109},{148,179,168,139},{182,222,208,169},{215,265,248,199},{248,309,288,229},{281,352,328,259},{314,395,367,289},{348,439,407,319},{381,482,447,349},{414,525,487,379},{447,569,527,409}}
soul_skill_data[2414] = {{100,78,85,108},{134,97,108,148},{168,116,132,188},{202,134,155,228},{236,153,179,268},{270,172,202,308},{304,190,226,348},{338,209,249,388},{372,228,272,428},{407,246,296,468},{441,265,319,508}}
soul_skill_data[2415] = {{1,1,1,1},{86,76,71,92},{120,98,89,131},{153,121,107,170},{186,144,125,209},{219,166,143,249},{253,189,160,288},{286,212,178,327},{319,235,196,366},{353,257,214,405},{386,280,232,444}}
--小乔 魅生
soul_skill_data[2416] = {{97,97,150,150},{121,121,200,200},{146,146,251,251},{170,170,302,302},{194,194,353,353},{218,218,403,403},{242,242,454,454},{266,266,505,505},{290,290,556,556},{315,315,606,606},{339,339,657,657}}
soul_skill_data[2417] = {{78,85,108,100},{97,108,148,134},{116,132,188,168},{134,155,228,202},{153,179,268,236},{172,202,308,270},{190,226,348,304},{209,249,388,338},{228,272,428,372},{246,296,468,407},{265,319,508,441}}
soul_skill_data[2418] = {{1,1,1,1},{76,71,86,92},{98,89,120,131},{121,107,153,170},{144,125,186,209},{166,143,219,249},{189,160,253,288},{212,178,286,327},{235,196,319,366},{257,214,353,405},{280,232,386,444}}
--甘宁 斗神
soul_skill_data[2419] = {{122,135,135,97},{158,179,179,121},{195,222,222,146},{231,265,265,170},{268,309,309,194},{304,352,352,218},{340,395,395,242},{377,439,439,266},{413,482,482,290},{450,525,525,315},{486,569,569,339}}
soul_skill_data[2420] = {{108,85,78,100},{148,108,97,134},{188,132,116,168},{228,155,134,202},{268,179,153,236},{308,202,172,270},{348,226,190,304},{388,249,209,338},{428,272,228,372},{468,296,246,407},{508,319,265,441}}
soul_skill_data[2421] = {{1,1,1,1},{86,86,81,71},{120,120,109,89},{153,153,136,107},{186,186,164,125},{219,219,192,143},{253,253,220,160},{286,286,248,178},{319,319,276,196},{353,353,303,214},{386,386,331,232}}
--周瑜 顾曲
soul_skill_data[2423] = {{109,109,135,135},{139,139,179,179},{169,169,222,222},{199,199,265,265},{229,229,309,309},{259,259,352,352},{289,289,395,395},{319,319,439,439},{349,349,482,482},{379,379,525,525},{409,409,569,569}}
soul_skill_data[2422] = {{85,78,108,100},{108,97,148,134},{132,116,188,168},{155,134,228,202},{179,153,268,236},{202,172,308,270},{226,190,348,304},{249,209,388,338},{272,228,428,372},{296,246,468,407},{319,265,508,441}}
soul_skill_data[2424] = {{1,1,1,1},{86,78,76,84},{120,103,98,114},{153,129,121,145},{186,154,144,175},{219,179,166,206},{253,204,189,236},{286,230,212,267},{319,255,235,297},{353,280,257,328},{386,305,280,358}}
--测试技能
soul_skill_data[2466] = {{1,1,1,1}}
--吕布 温侯
soul_skill_data[4602] = {{135,115,128,109},{165,138,155,129},{194,160,182,149},{223,182,209,169},{253,204,236,189},{282,227,263,209},{312,249,290,229},{341,271,317,249},{370,293,344,269},{400,316,371,289},{429,338,398,309}}
soul_skill_data[4604] = {{100,85,100,85},{134,108,134,108},{168,132,168,132},{202,155,202,155},{236,179,236,179},{270,202,270,202},{304,226,304,226},{338,249,338,249},{372,272,372,272},{407,296,407,296},{441,319,441,319}}
soul_skill_data[4603] = {{1,1,1,1},{101,76,94,81},{149,99,135,110},{197,121,176,138},{245,144,217,166},{293,167,258,195},{341,190,299,223},{389,213,340,252},{437,235,381,280},{484,258,421,308},{532,281,462,337}}
--黄月英 奇才
soul_skill_data[5000] = {{109,142,128,109},{134,181,162,134},{159,221,195,159},{184,260,228,184},{209,299,261,209},{234,338,294,234},{259,377,328,259},{284,416,361,284},{309,456,394,309},{334,495,427,334},{359,534,460,359}}
soul_skill_data[4998] = {{85,100,96,89},{108,134,127,115},{132,168,159,140},{155,202,190,166},{179,236,221,192},{202,270,252,218},{226,304,284,244},{249,338,315,270},{272,372,346,296},{296,407,377,322},{319,441,409,348}}
soul_skill_data[4999] = {{1,1,1,1},{76,84,84,81},{98,114,114,109},{121,145,145,136},{144,175,175,164},{166,206,206,192},{189,236,236,220},{212,267,267,248},{235,297,297,276},{257,328,328,303},{280,358,358,331}}
--貂禅 凤仪
soul_skill_data[5018] = {{109,135,135,109},{134,171,171,134},{159,208,208,159},{184,244,244,184},{209,280,280,209},{234,316,316,234},{259,352,352,259},{284,388,388,284},{309,424,424,309},{334,460,460,334},{359,497,497,359}}
soul_skill_data[5017] = {{85,96,100,89},{108,127,134,115},{132,159,168,140},{155,190,202,166},{179,221,236,192},{202,252,270,218},{226,284,304,244},{249,315,338,270},{272,346,372,296},{296,377,407,322},{319,409,441,348}}
soul_skill_data[5016] = {{1,1,1,1},{78,84,84,78},{103,114,114,103},{129,145,145,129},{154,175,175,154},{179,206,206,179},{204,236,236,204},{230,267,267,230},{255,297,297,255},{280,328,328,280},{305,358,358,305}}
--貂禅 国色
soul_skill_data[5062] = {{109,135,135,109},{134,171,171,134},{159,208,208,159},{184,244,244,184},{209,280,280,209},{234,316,316,234},{259,352,352,259},{284,388,388,284},{309,424,424,309},{334,460,460,334},{359,497,497,359}}
soul_skill_data[5061] = {{85,96,100,89},{108,127,134,115},{132,159,168,140},{155,190,202,166},{179,221,236,192},{202,252,270,218},{226,284,304,244},{249,315,338,270},{272,346,372,296},{296,377,407,322},{319,409,441,348}}
soul_skill_data[5060] = {{1,1,1,1},{78,84,84,78},{103,114,114,103},{129,145,145,129},{154,175,175,154},{179,206,206,179},{204,236,236,204},{230,267,267,230},{255,297,297,255},{280,328,328,280},{305,358,358,305}}
--典韦
soul_skill_data[5247] = {{150,109,97,135},{192,134,117,171},{234,159,137,208},{277,184,158,244},{319,209,178,280},{361,234,198,316},{403,259,218,352},{446,284,238,388},{488,309,258,424},{530,334,278,460},{573,359,298,497}}
soul_skill_data[5246] = {{96,82,85,108},{127,103,108,148},{159,124,132,188},{190,145,155,228},{221,166,179,268},{252,187,202,308},{284,208,226,348},{315,229,249,388},{346,250,272,428},{377,271,296,468},{409,292,319,508}}
soul_skill_data[5245] = {{1,1,1,1},{71,78,92,84},{89,103,131,114},{107,129,170,145},{125,154,209,175},{143,179,249,206},{160,204,288,236},{178,230,327,267},{196,255,366,297},{214,280,405,328},{232,305,444,358}}
--张春华
soul_skill_data[5253] = {{103,142,150,97},{126,181,192,117},{148,221,234,137},{171,260,277,158},{193,299,319,178},{216,338,361,198},{238,377,403,218},{261,416,446,238},{283,456,488,258},{306,495,530,278},{328,534,573,298}}
soul_skill_data[5252] = {{89,108,85,89},{115,148,108,115},{140,188,132,140},{166,228,155,166},{192,268,179,192},{218,308,202,218},{244,348,226,244},{270,388,249,270},{296,428,272,296},{322,468,296,322},{348,508,319,348}}
soul_skill_data[5251] = {{1,1,1,1},{78,84,81,81},{103,114,109,109},{129,145,136,136},{154,175,164,164},{179,206,192,192},{204,236,220,220},{230,267,248,248},{255,297,276,276},{280,328,303,303},{305,358,331,331}}
--霸王
soul_skill_data[5261] = {{152,111,99,137},{194,136,119,173},{236,161,139,210},{279,186,160,246},{321,211,180,282},{363,236,200,318},{405,261,220,354},{448,286,240,390},{490,311,260,426},{532,336,280,462},{575,361,300,499}}
soul_skill_data[5260] = {{87,110,84,98},{110,150,105,129},{134,190,126,161},{157,230,147,192},{181,270,168,223},{204,310,189,254},{228,350,210,286},{251,390,231,317},{274,430,252,348},{298,470,273,379},{321,510,294,411}}
soul_skill_data[5259] = {{1,1,1,1},{86,88,78,80},{116,122,100,105},{147,155,123,131},{177,188,146,156},{208,221,168,181},{238,255,191,206},{269,288,214,232},{299,321,237,257},{330,355,259,282},{360,388,282,307}}
--张飞
soul_skill_data[5380] = {{150,103,135,103},{192,126,171,126},{234,148,208,148},{277,171,244,171},{319,193,280,193},{361,216,316,216},{403,238,352,238},{446,261,388,261},{488,283,424,283},{530,306,460,306},{573,328,497,328}}
soul_skill_data[5379] = {{104,85,96,85},{141,108,127,108},{178,132,159,132},{215,155,190,155},{252,179,221,179},{289,202,252,202},{326,226,284,226},{363,249,315,249},{400,272,346,272},{437,296,377,296},{474,319,409,319}}
soul_skill_data[5378] = {{1,1,1,1},{84,78,81,81},{114,103,109,109},{145,129,136,136},{175,154,164,164},{206,179,192,192},{236,204,220,220},{267,230,248,248},{297,255,276,276},{328,280,303,303},{358,305,331,331}}
--刘备
soul_skill_data[5408] = {{137,111,152,99},{181,141,202,123},{224,171,253,148},{267,201,304,172},{311,231,355,196},{354,261,405,220},{397,291,456,244},{441,321,507,268},{484,351,558,292},{527,381,608,317},{571,411,659,341}}
soul_skill_data[5407] = {{98,87,110,84},{129,110,150,105},{161,134,190,126},{192,157,230,147},{223,181,270,168},{254,204,310,189},{286,228,350,210},{317,251,390,231},{348,274,430,252},{379,298,470,273},{411,321,510,294}}
soul_skill_data[5406] = {{1,1,1,1},{86,88,78,80},{116,122,100,105},{147,155,123,131},{177,188,146,156},{208,221,168,181},{238,255,191,206},{269,288,214,232},{299,321,237,257},{330,355,259,282},{360,388,282,307}}
--曹操
soul_skill_data[5414] = {{111,152,137,99},{141,202,181,123},{171,253,224,148},{201,304,267,172},{231,355,311,196},{261,405,354,220},{291,456,397,244},{321,507,441,268},{351,558,484,292},{381,608,527,317},{411,659,571,341}}
soul_skill_data[5413] = {{98,110,87,84},{129,150,110,105},{161,190,134,126},{192,230,157,147},{223,270,181,168},{254,310,204,189},{286,350,228,210},{317,390,251,231},{348,430,274,252},{379,470,298,273},{411,510,321,294}}
soul_skill_data[5412] = {{1,1,1,1},{86,78,88,80},{116,100,122,105},{147,123,155,131},{177,146,188,156},{208,168,221,181},{238,191,255,206},{269,214,288,232},{299,237,321,257},{330,259,355,282},{360,282,388,307}}
--孙权
soul_skill_data[5420] = {{111,152,137,99},{141,202,181,123},{171,253,224,148},{201,304,267,172},{231,355,311,196},{261,405,354,220},{291,456,397,244},{321,507,441,268},{351,558,484,292},{381,608,527,317},{411,659,571,341}}
soul_skill_data[5419] = {{87,110,98,84},{110,150,129,105},{134,190,161,126},{157,230,192,147},{181,270,223,168},{204,310,254,189},{228,350,286,210},{251,390,317,231},{274,430,348,252},{298,470,379,273},{321,510,411,294}}
soul_skill_data[5418] = {{1,1,1,1},{88,78,86,80},{122,100,116,105},{155,123,147,131},{188,146,177,156},{221,168,208,181},{255,191,238,206},{288,214,269,232},{321,237,299,257},{355,259,330,282},{388,282,360,307}}
--赵云
soul_skill_data[5456] = {{142,109,135,103},{189,139,179,130},{236,169,222,157},{283,199,265,184},{330,229,309,211},{377,259,352,238},{424,289,395,265},{471,319,439,292},{518,349,482,319},{565,379,525,346},{612,409,569,373}}
soul_skill_data[5455] = {{104,85,96,85},{141,108,127,108},{178,132,159,132},{215,155,190,155},{252,179,221,179},{289,202,252,202},{326,226,284,226},{363,249,315,249},{400,272,346,272},{437,296,377,296},{474,319,409,319}}
soul_skill_data[5454] = {{1,1,1,1},{81,81,86,76},{109,109,120,98},{136,136,153,121},{164,164,186,144},{192,192,219,166},{220,220,253,189},{248,248,286,212},{276,276,319,235},{303,303,353,257},{331,331,386,280}}


--------------------------------------------------------------------
--某id的战魂对应的可获得的技能id（skill id的数量不得超过3个：攻击类、护佑类、阵法类魂技各一个）
--阵法类魂技暂时未开放
--（0表示技能位为空，如果战魂没有任何技能也要建个空table：soul_id_skill[xxxxx] = {0,0,0}）
local soul_id_skill = {}
--测试用战魂
soul_id_skill[43710] = {2466,0,0}
soul_id_skill[44637] = {2396,2397,0}
--正式版战魂
----普通版
soul_id_skill[44876] = {2394,2395,0}
soul_id_skill[44877] = {2396,2397,0}
----名将版
soul_id_skill[44878] = {2399,2400,2398}
soul_id_skill[44879] = soul_id_skill[44878]
soul_id_skill[44880] = soul_id_skill[44878]
soul_id_skill[44881] = {2402,2403,2401}
soul_id_skill[44882] = soul_id_skill[44881]
soul_id_skill[44883] = soul_id_skill[44881]
soul_id_skill[44884] = {2405,2406,2404}
soul_id_skill[44885] = soul_id_skill[44884]
soul_id_skill[44886] = soul_id_skill[44884]
soul_id_skill[44887] = {2408,2409,2407}
soul_id_skill[44888] = soul_id_skill[44887]
soul_id_skill[44905] = soul_id_skill[44887]
soul_id_skill[44890] = {2410,2412,2411}
soul_id_skill[44891] = soul_id_skill[44890]
soul_id_skill[44892] = soul_id_skill[44890]
soul_id_skill[44893] = {2414,2415,2413}
soul_id_skill[44894] = soul_id_skill[44893]
soul_id_skill[44895] = soul_id_skill[44893]
soul_id_skill[44896] = {2417,2418,2416}
soul_id_skill[44897] = soul_id_skill[44896]
soul_id_skill[44898] = soul_id_skill[44896]
soul_id_skill[44899] = {2420,2421,2419}
soul_id_skill[44900] = soul_id_skill[44899]
soul_id_skill[44901] = soul_id_skill[44899]
soul_id_skill[44902] = {2422,2424,2423}
soul_id_skill[44903] = soul_id_skill[44902]
soul_id_skill[44904] = soul_id_skill[44902]
soul_id_skill[80991] = {4602,4604,4603}
soul_id_skill[83983] = {5000,4999,4998}
soul_id_skill[84148] = {5018,5017,5016}
soul_id_skill[84393] = {5062,5061,5060}
soul_id_skill[86359] = {5247,5246,5245}
soul_id_skill[86360] = {5253,5252,5251}
soul_id_skill[86361] = {5261,5260,5259}
soul_id_skill[88724] = {5380,5379,5378}
soul_id_skill[89059] = {5408,5407,5406}
soul_id_skill[89060] = {5414,5413,5412}
soul_id_skill[89061] = {5420,5419,5418}
soul_id_skill[88733] = {5456,5455,5454}

--充值促销用战魂
----中档战魂：（蓝色战魂，但比游戏中的蓝色名将战魂多一档本体属性）
soul_id_skill[47575] = soul_id_skill[44886]
soul_id_skill[47576] = soul_id_skill[44880]
soul_id_skill[47577] = soul_id_skill[44901]
----纪念版战魂：（紫色战魂，60级可装备，比游戏中的紫色名将战魂多一档本体属性）
soul_id_skill[45300] = soul_id_skill[44905]
soul_id_skill[45301] = soul_id_skill[44892]
soul_id_skill[45302] = soul_id_skill[44898]
----专属战魂：（橙色战魂，60级可装备，1级时的基础属性比纪念版更高）
soul_id_skill[47579] = soul_id_skill[44905]
soul_id_skill[47580] = soul_id_skill[44892]
soul_id_skill[47581] = soul_id_skill[44898]
----自定义战魂：（紫色战魂，60级可装备，自定义名称，无最低档本体属性）
soul_id_skill[48436] = soul_id_skill[44905]
soul_id_skill[48437] = soul_id_skill[44883]
soul_id_skill[48438] = soul_id_skill[44904]
soul_id_skill[48439] = soul_id_skill[44901]
soul_id_skill[48440] = soul_id_skill[44895]
soul_id_skill[48441] = soul_id_skill[44904]
soul_id_skill[48442] = soul_id_skill[44895]
soul_id_skill[48443] = soul_id_skill[44898]
soul_id_skill[48444] = soul_id_skill[44895]
soul_id_skill[48445] = soul_id_skill[44901]
soul_id_skill[48446] = soul_id_skill[44905]
soul_id_skill[48447] = soul_id_skill[44905]
soul_id_skill[48448] = soul_id_skill[44895]
soul_id_skill[48449] = soul_id_skill[44905]
----幸运大抽奖活动产出的极品战魂（紫色战魂，60级可装备，本体属性最高档）
soul_id_skill[52636] = soul_id_skill[44901]
soul_id_skill[52637] = soul_id_skill[44905]
soul_id_skill[52638] = soul_id_skill[44895]
soul_id_skill[52639] = soul_id_skill[44880]
soul_id_skill[52640] = soul_id_skill[44898]
soul_id_skill[52641] = soul_id_skill[44886]
soul_id_skill[52642] = soul_id_skill[44883]
soul_id_skill[52643] = soul_id_skill[44904]
soul_id_skill[52644] = soul_id_skill[44892]


--------------------------------------------------------------------
--战魂技能id及等级对应的技能附加属性组id>>>>>>>>>>注意：技能附加属性组只能填第一项附加属性，且类型必须为43！<<<<<<<<<<
--1. 目前战魂技能最高为11级。
--2. 每个战魂技能及等级对应一个附加属性组。
--3. 战魂技能的附加属性组会由程序特别处理，未获得时不会显示在悬浮说明里。
local soul_skill_addongroup = {}
soul_skill_addongroup[2394] = {45879,45880,45881,45882,45883,45884,45885,45886,45887,45888,47649}
soul_skill_addongroup[2395] = {45889,45890,45891,45892,45893,45894,45895,45896,45897,45898,47650}
soul_skill_addongroup[2396] = {45899,45900,45901,45902,45903,45904,45905,45906,45907,45908,47651}
soul_skill_addongroup[2397] = {45909,45910,45911,45912,45913,45914,45915,45916,45917,45918,47652}
soul_skill_addongroup[2398] = {45919,45920,45921,45922,45923,45924,45925,45926,45927,45928,47653}
soul_skill_addongroup[2399] = {45929,45930,45931,45932,45933,45934,45935,45936,45937,45938,47654}
soul_skill_addongroup[2400] = {45939,45940,45941,45942,45943,45944,45945,45946,45947,45948,47655}
soul_skill_addongroup[2401] = {45949,45950,45951,45952,45953,45954,45955,45956,45957,45958,47656}
soul_skill_addongroup[2402] = {45959,45960,45961,45962,45963,45964,45965,45966,45967,45968,47657}
soul_skill_addongroup[2403] = {45969,45970,45971,45972,45973,45974,45975,45976,45977,45978,47658}
soul_skill_addongroup[2404] = {45979,45980,45981,45982,45983,45984,45985,45986,45987,45988,47659}
soul_skill_addongroup[2405] = {45989,45990,45991,45992,45993,45994,45995,45996,45997,45998,47660}
soul_skill_addongroup[2406] = {45999,46000,46001,46002,46003,46004,46005,46006,46007,46008,47661}
soul_skill_addongroup[2407] = {46009,46010,46011,46012,46013,46014,46015,46016,46017,46018,47662}
soul_skill_addongroup[2408] = {46019,46020,46021,46022,46023,46024,46025,46026,46027,46028,47663}
soul_skill_addongroup[2409] = {46029,46030,46031,46032,46033,46034,46035,46036,46037,46038,47664}
soul_skill_addongroup[2410] = {46039,46040,46041,46042,46043,46044,46045,46046,46047,46048,47665}
soul_skill_addongroup[2411] = {46049,46050,46051,46052,46053,46054,46055,46056,46057,46058,47666}
soul_skill_addongroup[2412] = {46059,46060,46061,46062,46063,46064,46065,46066,46067,46068,47667}
soul_skill_addongroup[2413] = {46069,46070,46071,46072,46073,46074,46075,46076,46077,46078,47668}
soul_skill_addongroup[2414] = {46079,46080,46081,46082,46083,46084,46085,46086,46087,46088,47669}
soul_skill_addongroup[2415] = {46089,46090,46091,46092,46093,46094,46095,46096,46097,46098,47670}
soul_skill_addongroup[2416] = {46099,46100,46101,46102,46103,46104,46105,46106,46107,46108,47671}
soul_skill_addongroup[2417] = {46109,46110,46111,46112,46113,46114,46115,46116,46117,46118,47672}
soul_skill_addongroup[2418] = {46119,46120,46121,46122,46123,46124,46125,46126,46127,46128,47673}
soul_skill_addongroup[2419] = {46129,46130,46131,46132,46133,46134,46135,46136,46137,46138,47674}
soul_skill_addongroup[2420] = {46139,46140,46141,46142,46143,46144,46145,46146,46147,46148,47675}
soul_skill_addongroup[2421] = {46149,46150,46151,46152,46153,46154,46155,46156,46157,46158,47676}
soul_skill_addongroup[2422] = {46159,46160,46161,46162,46163,46164,46165,46166,46167,46168,47677}
soul_skill_addongroup[2423] = {46169,46170,46171,46172,46173,46174,46175,46176,46177,46178,47678}
soul_skill_addongroup[2424] = {46179,46180,46181,46182,46183,46184,46185,46186,46187,46188,47679}
soul_skill_addongroup[4602] = {81038,81039,81040,81041,81042,81043,81044,81045,81046,81047,81048}
soul_skill_addongroup[4603] = {81049,81050,81051,81052,81053,81054,81055,81056,81057,81058,81059}
soul_skill_addongroup[4604] = {81060,81061,81062,81063,81064,81065,81066,81067,81068,81069,81070}
soul_skill_addongroup[5000] = {84022,84023,84024,84025,84026,84027,84028,84029,84030,84031,84032}
soul_skill_addongroup[4999] = {84011,84012,84013,84014,84015,84016,84017,84018,84019,84020,84021}
soul_skill_addongroup[4998] = {84000,84001,84002,84003,84004,84005,84006,84007,84008,84009,84010}
soul_skill_addongroup[5018] = {84220,84221,84222,84223,84224,84225,84226,84227,84228,84229,84230}
soul_skill_addongroup[5017] = {84209,84210,84211,84212,84213,84214,84215,84216,84217,84218,84219}
soul_skill_addongroup[5016] = {84198,84199,84200,84201,84202,84203,84204,84205,84206,84207,84208}
soul_skill_addongroup[5062] = {84340,84341,84342,84343,84344,84345,84346,84347,84348,84349,84350}
soul_skill_addongroup[5061] = {84329,84330,84331,84332,84333,84334,84335,84336,84337,84338,84339}
soul_skill_addongroup[5060] = {84318,84319,84320,84321,84322,84323,84324,84325,84326,84327,84328}
soul_skill_addongroup[5245] = {86403,86404,86405,86406,86407,86408,86409,86410,86411,86412,86413}
soul_skill_addongroup[5246] = {86414,86415,86416,86417,86418,86419,86420,86421,86422,86423,86424}
soul_skill_addongroup[5247] = {86425,86426,86427,86428,86429,86430,86431,86432,86433,86434,86435}
soul_skill_addongroup[5251] = {86452,86453,86454,86455,86456,86457,86458,86459,86460,86461,86462}
soul_skill_addongroup[5252] = {86463,86464,86465,86466,86467,86468,86469,86470,86471,86472,86473}
soul_skill_addongroup[5253] = {86474,86475,86476,86477,86478,86479,86480,86481,86482,86483,86484}
soul_skill_addongroup[5259] = {86501,86502,86503,86504,86505,86506,86507,86508,86509,86510,86511}
soul_skill_addongroup[5260] = {86512,86513,86514,86515,86516,86517,86518,86519,86520,86521,86522}
soul_skill_addongroup[5261] = {86523,86524,86525,86526,86527,86528,86529,86530,86531,86532,86533}
soul_skill_addongroup[5378] = {88750,88751,88752,88753,88754,88755,88756,88757,88758,88759,88760}
soul_skill_addongroup[5379] = {88761,88762,88763,88764,88765,88766,88767,88768,88769,88770,88771}
soul_skill_addongroup[5380] = {88772,88773,88774,88775,88776,88777,88778,88779,88780,88781,88782}
soul_skill_addongroup[5406] = {89079,89080,89081,89082,89083,89084,89085,89086,89087,89088,89089}
soul_skill_addongroup[5407] = {89090,89091,89092,89093,89094,89095,89096,89097,89098,89099,89100}
soul_skill_addongroup[5408] = {89101,89102,89103,89104,89105,89106,89107,89108,89109,89110,89111}
soul_skill_addongroup[5412] = {89128,89129,89130,89131,89132,89133,89134,89135,89136,89137,89138}
soul_skill_addongroup[5413] = {89139,89140,89141,89142,89143,89144,89145,89146,89147,89148,89149}
soul_skill_addongroup[5414] = {89150,89151,89152,89153,89154,89155,89156,89157,89158,89159,89160}
soul_skill_addongroup[5418] = {89177,89178,89179,89180,89181,89182,89183,89184,89185,89186,89187}
soul_skill_addongroup[5419] = {89188,89189,89190,89191,89192,89193,89194,89195,89196,89197,89198}
soul_skill_addongroup[5420] = {89199,89200,89201,89202,89203,89204,89205,89206,89207,89208,89209}
soul_skill_addongroup[5454] = {89557,89558,89559,89560,89561,89562,89563,89564,89565,89566,89567}
soul_skill_addongroup[5455] = {89568,89569,89570,89571,89572,89573,89574,89575,89576,89577,89578}
soul_skill_addongroup[5456] = {89579,89580,89581,89582,89583,89584,89585,89586,89587,89588,89589}

local anima_class_tid = {
	44880, 44883, 44886, 44905, 44892, 
	44895, 44898, 44901, 44904, 80991, 
	83983, 84148, 84393, 86359, 86360, 
	86361, 88724, 88733, 89059, 89060,
	89061
}


--计算战魂技能的当前等级
function CheckSkillAtt(need,att)
	local sklv = 0
	local attchk
	for k,v in ipairs(need) do
		attchk = true
		for g,h in ipairs(v) do
			if att[g] < h then
				attchk = false
				break
			end			
		end
		if attchk then sklv = k	else break end
	end
	return sklv
end

--根据现有的技能附加属性组tab和战魂id计算战魂已学会的魂技tab
--现在最多3项魂技，魂技tab包括skillid和skilllv
--skilllv为0时即表示未学会该技能
function SkillApponGroupToSkillTab(id, addtab)
	local skilltab = {}
	--以下算法忘了，生写的……>_<
	if soul_id_skill[id] ~= nil then
		local skillid = {}
		local skilllv = {}
		for num = 1,3 do
			skillid[num] = soul_id_skill[id][num]
			skilllv[num] = 0
			if skillid[num] > 0 then
				for k,v in ipairs(soul_skill_addongroup[skillid[num]]) do
					for s,t in ipairs(addtab) do
						if t == v then
							skilllv[num] = k
							break
						end					
					end
				end
			end
		end
		skilltab = {{skillid[1],skilllv[1]},{skillid[2],skilllv[2]},{skillid[3],skilllv[3]}}	
	else
		skilltab = {{0,0},{0,0},{0,0}}
	end
	return skilltab
end

--计算战魂的当前技能
--战魂获得技能的条件是四项属性是否达到需求
--skilltab：之前的技能id和等级tab
function CountSoulSkill(op_type, att1, att2, att3, att4, skilltab, evotimes, t_ap1, t_ap2, t_ap3, t_ap4)
	local skillid = {}
	local skilllv = {}
	--转生后的四项属性需求判定需要先把战魂属性减去天资*0.2*转生次数
	local nowatt = {}
	nowatt[1] = att1-math.floor(t_ap1*0.2*evotimes)
	nowatt[2] = att2-math.floor(t_ap2*0.2*evotimes)
	nowatt[3] = att3-math.floor(t_ap3*0.2*evotimes)
	nowatt[4] = att4-math.floor(t_ap4*0.2*evotimes)	
	--技能最多最多为3个，护佑、攻击、阵法各一
	for num = 1, 3 do
		skillid[num] = skilltab[num][1]
		skilllv[num] = CheckSkillAtt(soul_skill_data[skillid[num]], nowatt)
		--如果是升级，计算结果中的技能等级不会低于之前的技能等级
		if skilllv[num] < skilltab[num][2] and op_type == 2 then
			skilllv[num] = skilltab[num][2]
		end
	end 
	--技能table表
	local nowskill = {{skillid[1],skilllv[1]},{skillid[2],skilllv[2]},{skillid[3],skilllv[3]}}		
	return nowskill
end

local datamember = 
{
	this = "Win_WarAnimaGuideComp",
}

Win_WarAnimaGuideComp = DlgTemplate:new(datamember)

function Win_WarAnimaGuideComp:Init()

end

function Win_WarAnimaGuideComp:ShowDialog()

end

function Win_WarAnimaGuideComp:OnLButtonDown(objName)
    
end

function Win_WarAnimaGuideComp:BuildSultResult(tid, evotimes, att1, att2, att3, att4, t_ap1, t_ap2, t_ap3, t_ap4)
    skilltab = SkillApponGroupToSkillTab(tid, soul_skill_addongroup)
    curSkills = CountSoulSkill(0, att1, att2, att3, att4, skilltab, evotimes, t_ap1, t_ap2, t_ap3, t_ap4)
    return curSkills
end

function Win_WarAnimaGuideComp:GetAnimaClassTid()
    return anima_class_tid
end


